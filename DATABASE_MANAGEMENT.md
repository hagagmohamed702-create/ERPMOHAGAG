# إدارة قاعدة البيانات

## الأوامر المتاحة

### 1. إعادة تعيين قاعدة البيانات
```bash
npm run db:reset
```
هذا الأمر يقوم بـ:
- حذف جميع الجداول
- إعادة إنشاء الجداول من السكيما
- إضافة البيانات الأساسية (الحسابات، الصندوق، المخزن)

### 2. بذر قاعدة البيانات
```bash
npm run db:seed
```
يضيف البيانات الأساسية فقط:
- 4 حسابات أساسية (صندوق، بنك، عملاء، موردين)
- صندوق رئيسي
- مخزن رئيسي
- 3 مواد أساسية

### 3. إعادة التعيين والبذر معاً
```bash
npm run db:reset-and-seed
```
ينفذ الأمرين السابقين بالتتابع

## ملاحظات مهمة

⚠️ **تحذير**: هذه الأوامر ستحذف جميع البيانات الموجودة في قاعدة البيانات!

### قبل التنفيذ:
1. تأكد من وجود ملف `.env` مع `DATABASE_URL` الصحيح
2. خذ نسخة احتياطية من البيانات المهمة
3. تأكد أنك تعمل على قاعدة البيانات الصحيحة

### البيانات الأساسية المنشأة:

#### الحسابات:
- ACC-001: الصندوق الرئيسي
- ACC-002: البنك الأهلي
- ACC-003: حساب العملاء
- ACC-004: حساب الموردين

#### المواد:
- MAT-001: أسمنت (25 ريال/كيس)
- MAT-002: حديد تسليح (5000 ريال/طن)
- MAT-003: رمل (80 ريال/م³)



## استكشاف الأخطاء

### خطأ في الاتصال بقاعدة البيانات:
```
Error: P1001: Can't reach database server
```
**الحل**: تأكد من صحة `DATABASE_URL` في ملف `.env`

### خطأ في الصلاحيات:
```
Error: permission denied for schema public
```
**الحل**: تأكد من صلاحيات المستخدم في قاعدة البيانات

### خطأ في السكيما:
```
Error: P3005: The database schema is not empty
```
**الحل**: استخدم `npm run db:reset` لحذف البيانات أولاً